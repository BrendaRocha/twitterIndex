import json
from nltk.stem import SnowballStemmer
from nltk.corpus import stopwords
import unittest
from test import support

from Menu_operaciones import Menu_de_operaciones

menu = Menu_de_operaciones()
menu.aceptar_palabras("messi OR psg", "neymar", 10)



def test_pasaje_fecha_numero1():
    fecha = "2021-10-21 03:23"
    fecha_pasada_numero = menu.pasaje_fecha_a_numero(fecha)
    assert fecha_pasada_numero == 202110210323

def test_pasaje_fecha_numero2():
    fecha = "9999-99-99 99:99"
    fecha_pasada_numero = menu.pasaje_fecha_a_numero(fecha)
    assert fecha_pasada_numero == 999999999999

def test_pasaje_fecha_numero3_con_espacios():
    fecha = "1234 12 18 12 43"
    fecha_pasada_numero = menu.pasaje_fecha_a_numero(fecha)
    assert fecha_pasada_numero == 123412181243

def test_pasaje_fecha_numero4_doble_signos():
    fecha = "2021--10--21  03::23"
    fecha_pasada_numero = menu.pasaje_fecha_a_numero(fecha)
    assert fecha_pasada_numero == 202110210323

def test_pasaje_fecha_numero5_erronea():
    fecha = "320917561293"
    fecha_pasada_numero = menu.pasaje_fecha_a_numero(fecha)
    assert fecha_pasada_numero == 320917561293

def test_conjunto_id_negadas():
    query_NOT = "neymar"
    id_tweets = menu.conjunto_id_negadas(query_NOT)
    conjunto = {1452921065072730112, 1457165910901469184, 1452044913919635458, 1451541348239167492}
    assert conjunto == id_tweets

def test_conjunto_id_final():
    query = "messi OR psg"
    id_tweets = menu.crear_operacion(query,"neymar")
    conjunto = {1450892545119199232, 1451601216530788352, 1451609538810032131, 1451650149885882371, 1451223843033518080, 1451235981491724289, 1451360681488535559, 1452692293631332354, 1450893368259747840, 1451597885225590794, 1451530060373106699, 1452653600585535499, 1451249583909134341, 1451236233573650446, 1451598846052741126, 1452692272936595469, 1453383237154316296, 1451176514439942153, 1451576579662942218, 1452953781025579019, 1452995134426132492, 1452296216365211662, 1451250819286765591, 
    1451609343846191119, 1453394875207008260, 1451234905707454467, 1452275111076192260, 1456412022535512068, 1451603530918371332, 1450650611863543813, 1451599147061051398, 1451235495871143941, 1451633028799897605, 1451272552274436104, 1452634530154749961, 1452938061738909699, 1452323233718493196, 1453083712120233985, 1451600069296201729, 1452416919202512897, 1451602755785662466, 1451597943706882048, 1451598184547950594, 1454188552963584000, 1450888890651488256, 1450833970808205312, 1451603357362278401, 1452938823604768769, 1452626719651860481, 1452455557290504193, 1453500363290693634, 1453489199483604994, 1454579042548690946, 1457482542299426818, 1451222353321594883, 1451251117862490115, 1452098408974635011, 1453500618979545091, 1451713084448460803, 1455647276337188868, 1452274683173294084, 1453486560033320964, 1450868941631406080, 1451598788850814981, 1452278056819822598, 1450647235566342151, 1451604965743599618, 1452315669433884674, 1452292891754250241, 1451015985327067146, 1455656734152876033, 1453407756057301004, 1451600450554372096, 1452312428709093376, 1450987868357287938, 1452274549463130113, 1451600662303842304}
    assert conjunto == id_tweets

def test_lista_diccionarios():
    query = "messi OR psg"
    resultado = menu.conjuntos_id_tweets(query)
    lista_dicts = [{'0': {'1451223843033518080', '1451713084448460803', '1451236233573650446', '1451604965743599618', '1451576579662942218', '1452995134426132492', '1450888890651488256', '1450868941631406080', '1450892545119199232', '1452634530154749961', '1451602755785662466', '1451599147061051398', '1451222353321594883', '1451176514439942153', '1452692293631332354', '1452044913919635458', '1451609538810032131', '1451235495871143941', '1451598846052741126', '1451650149885882371', '1451598788850814981', '1451530060373106699', '1451597885225590794', '1451360681488535559', '1452692272936595469', '1451633028799897605', '1451600069296201729', '1451603530918371332', '1451609343846191119', '1451250819286765591', '1452653600585535499', '1451601216530788352', '1451249583909134341', '1453083712120233985', '1452626719651860481', '1451234905707454467', '1451235981491724289', '1451251117862490115', '1451603357362278401', '1452416919202512897', '1451597943706882048', '1450893368259747840', '1451600450554372096', '1451600662303842304', '1451598184547950594', '1450833970808205312'}, '1': {'1454579042548690946', '1451713084448460803', '1450650611863543813', '1450647235566342151', '1452416919202512897', '1452098408974635011', '1457482542299426818', '1452455557290504193'}, '2': {'1451713084448460803', '1452938061738909699', '1452315669433884674', '1450888890651488256', '1452995134426132492', '1450892545119199232', '1452634530154749961', '1452323233718493196', '1452953781025579019', '1450650611863543813', '1452312428709093376', '1452044913919635458', '1451650149885882371', '1452278056819822598', '1450647235566342151', '1452292891754250241', '1452938823604768769', '1452296216365211662', '1452274549463130113', '1452626719651860481', '1450987868357287938', '1452274683173294084', '1452275111076192260', '1450893368259747840', '1451015985327067146'}, '3': {'1454188552963584000', '1456412022535512068', '1453407756057301004', '1453500363290693634', '1453486560033320964', '1453383237154316296', '1453394875207008260', '1453489199483604994', '1453500618979545091', '1455656734152876033', '1455647276337188868'}}, {'0': {'1451272552274436104', '1450833970808205312'}}]
    assert lista_dicts == resultado


